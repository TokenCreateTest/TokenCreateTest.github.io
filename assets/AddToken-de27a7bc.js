import{D as S}from"./Dialog-2d7a7a87.js";import{_ as A,d as V,b as $,g as i,e as C,r as w,o as T,k as B,a as U,l as o,w as c,u as f,F as E,n as u,D as H,E as x,I as D,H as N,v as O,t as F}from"./index-bc429cca.js";import{u as I}from"./manage-fd6da509.js";import{c as M,f as W}from"./index-1e7d7341.js";/* empty css                                                       */const L={class:"add-token"},P={__name:"AddToken",setup(j){const{t:n}=V(),b=$(),l=I(),v=i(""),d=i(b.walletAddress),p=i(""),h=C(()=>n("operationHash",{hash:W(v.value)})),m=i(!1),g=i(!1);function _(e){return e.replace("-","")}async function k(){if(!p.value){u(n("amountWarn"));return}if(!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(d.value)){u(n("addressWrong"));return}g.value=!0;try{const t=await new H(window.ethereum).getSigner(),s=new x(l.tokenAddress,l.abi,t);let r=await s.mint(d.value,D(p.value,l.decimals));v.value=r.hash,r.wait().then(async y=>{if(y.status===1){u({type:"success",message:n("upChainSuccessfully")});let a=await s.totalSupply();l.totalSupply=N(a.toString(),l.decimals)}}),m.value=!0}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?u(n("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?u(n("userCancelOperate")):u(n("unkonwError"))}finally{g.value=!1}}return(e,t)=>{const s=w("van-field"),r=w("van-cell-group"),y=w("van-button");return T(),B(E,null,[U("div",L,[o(r,{inset:""},{default:c(()=>[o(s,{modelValue:f(l).totalSupply,"onUpdate:modelValue":t[0]||(t[0]=a=>f(l).totalSupply=a),readonly:"",label:e.$t("currentTotal"),"input-align":"right"},null,8,["modelValue","label"])]),_:1}),o(r,{inset:""},{default:c(()=>[o(s,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=a=>p.value=a),type:"number",label:e.$t("addTokenAmount"),placeholder:e.$t("pleaseEnter"),formatter:_,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),o(r,{inset:""},{default:c(()=>[o(s,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value=a),"label-width":"9em",label:e.$t("receivingAddress"),placeholder:e.$t("pleaseEnter"),"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),o(y,{type:"primary",round:"",block:"",class:"btn",onClick:k,loading:g.value},{default:c(()=>[O(F(e.$t("submitAdd")),1)]),_:1},8,["loading"])]),o(S,{show:m.value,"onUpdate:show":t[3]||(t[3]=a=>m.value=a),title:e.$t("submitAddSuccessfully"),message:f(h),cancelButtonText:e.$t("thinkAgain"),confirmButtonText:e.$t("copyHash"),onOnConfirm:t[4]||(t[4]=a=>f(M)(v.value)),onOnCancel:t[5]||(t[5]=a=>m.value=!1)},null,8,["show","title","message","cancelButtonText","confirmButtonText"])],64)}}},Q=A(P,[["__scopeId","data-v-558e6f8b"]]);export{Q as default};
