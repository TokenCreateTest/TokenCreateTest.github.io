import{_ as V,$ as N,e as S,h as v,r as g,o as w,l as L,b as p,m as d,w as _,t as h,F as W,v as R,u as a,q as k,p as r,x as y,n as I}from"./index-736b0d16.js";import{f as U,c as z}from"./index-0b8c187f.js";import{u as M}from"./manage-b08eda84.js";import{_ as q}from"./SvgIcon-3d78548a.js";import{D as B}from"./Dialog-ef2c1a93.js";import"./bignumber-3e8dfdf6.js";import"./units-bacceeeb.js";/* empty css                                                       */const E={class:"name-manage"},j={class:"name-list"},G={class:"title"},H={class:"list-item"},J={class:"address"},K={__name:"WhiteList",setup(P){N();const{t:s}=S(),c=v(!1),m=v(!1),u=v(!1),o=M(),i=v(""),f=v("");function x(t){return t&&t.trim()}function C(){if(!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(i.value)){r(s("trueFormat"));return}if(o.whiteList.findIndex(e=>e==i.value)!=-1){r(s("addressAdded"));return}c.value=!0}function A(){c.value=!1,m.value=!1}async function b(){u.value=!0;let t=i.value;try{const e=await k.token.contract(o.tokenAddress,o.abi);console.log(e);const l=await e.setFeeWhiteList([i.value],!0);console.log(l),await l.wait(),await o.getWhiteList(o.tokenAddress),i.value="",c.value=!1,r({type:"success",message:s("addWhiteListSuccess",{userAddress:t})})}catch(e){console.log(e),e.code===4001?r(s("userCancelOperate")):r(s("addWhiteListFail",{userAddress:t}))}finally{u.value=!1}}function T(t){f.value=t,m.value=!0}async function F(){u.value=!0;let t=f.value;try{const e=await k.token.contract(o.tokenAddress,o.abi);console.log(e);const l=await e.setFeeWhiteList([f.value],!1);console.log(l),await l.wait(),await o.getWhiteList(o.tokenAddress),f.value="",m.value=!1,r({type:"success",message:s("addWhiteListSuccess",{userAddress:t})})}catch(e){e.code===4001?r(s("userCancelOperate")):r(s("removeWhiteListFail",{userAddress:t}))}finally{u.value=!1}}return(t,e)=>{const l=g("van-button"),$=g("van-field"),D=g("van-cell-group");return w(),L(W,null,[p("div",E,[d(D,{inset:""},{default:_(()=>[d($,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value=n),center:"",clearable:"",formatter:x,placeholder:a(s)("inputAddress")},{button:_(()=>[d(l,{class:"add-btn",size:"mini",type:"primary",round:"",onClick:C},{default:_(()=>[y(h(t.$t("add")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),p("div",j,[p("div",G,h(t.$t("added")),1),p("ul",null,[(w(!0),L(W,null,R(a(o).whiteList,n=>(w(),L("li",H,[p("div",J,[y(h(a(U)(n))+" ",1),d(q,{class:"copy-icon",name:"copy",onClick:I(O=>a(z)(n),["stop"])},null,8,["onClick"])]),d(l,{class:"remove-btn",plain:"",size:"mini",type:"primary",round:"",onClick:O=>T(n)},{default:_(()=>[y(h(t.$t("remove")),1)]),_:2},1032,["onClick"])]))),256))])])]),d(B,{show:c.value,"onUpdate:show":e[1]||(e[1]=n=>c.value=n),message:a(s)("addWhiteListWarn",{userAddress:i.value,tokenName:a(o).symbol}),cancelButtonText:a(s)("thinkAgain"),confirmButtonLoading:u.value,confirmButtonText:a(s)("confirm"),onOnCancel:A,onOnConfirm:b},null,8,["show","message","cancelButtonText","confirmButtonLoading","confirmButtonText"]),d(B,{show:m.value,"onUpdate:show":e[2]||(e[2]=n=>m.value=n),message:a(s)("removeWhiteListWarn",{userAddress:f.value}),cancelButtonText:a(s)("thinkAgain"),confirmButtonLoading:u.value,confirmButtonText:a(s)("confirm"),onOnCancel:A,onOnConfirm:F},null,8,["show","message","cancelButtonText","confirmButtonLoading","confirmButtonText"])],64)}}},ae=V(K,[["__scopeId","data-v-b609eb33"]]);export{ae as default};
