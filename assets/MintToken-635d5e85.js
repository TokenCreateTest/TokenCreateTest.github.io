import{D as $}from"./Dialog-1a700249.js";import{_ as A,d as T,b as B,e as h,g as d,r as y,o as O,k as U,a as E,l,w as v,u as p,F as M,n as s,C as x,D,v as H,t as N}from"./index-a4fc57f9.js";import{u as F}from"./manage-65578f1f.js";import{c as L,f as I}from"./index-0a64932a.js";import{p as P,f as W}from"./units-6b9ea6dc.js";/* empty css                                                       */import"./bignumber-3e8dfdf6.js";const j={class:"mint-token"},q={__name:"MintToken",setup(z){const{t:n}=T(),b=B(),o=F(),_=h(()=>b.walletAddress.toLowerCase()===o.owner.toLowerCase()),g=d(""),m=d(b.walletAddress),r=d(""),k=h(()=>n("operationHash",{hash:I(g.value)})),c=d(!1),w=d(!1);function C(t){return t.replace("-","")}async function S(){if(!r.value){s(n("amountEmpty"));return}if(r.value.replace(".","").length>34){s(n("amountOver"));return}let t=r.value.split(".");if(t[1]&&t[1].length>o.decimals){s(n("amountOver"));return}if(!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(m.value)){s(n("addressWrong"));return}w.value=!0;try{const i=await new x(window.ethereum).getSigner(),u=new D(o.tokenAddress,o.abi,i);let f=await u.mint(m.value,P(r.value,o.decimals));g.value=f.hash,f.wait().then(async a=>{if(a.status===1){s({type:"success",message:n("upChainSuccessfully")});let V=await u.totalSupply();o.totalSupply=W(V.toString(),o.decimals),r.value=""}}),c.value=!0}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?s(n("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?s(n("userCancelOperate")):s(n("unkonwError"))}finally{w.value=!1}}return(t,e)=>{const i=y("van-field"),u=y("van-cell-group"),f=y("van-button");return O(),U(M,null,[E("div",j,[l(u,{inset:""},{default:v(()=>[l(i,{modelValue:p(o).totalSupply,"onUpdate:modelValue":e[0]||(e[0]=a=>p(o).totalSupply=a),readonly:"",label:t.$t("currentTotal"),"input-align":"right"},null,8,["modelValue","label"])]),_:1}),l(u,{inset:""},{default:v(()=>[l(i,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value=a),type:"number",label:t.$t("mintTokenAmount"),placeholder:t.$t("pleaseEnter"),formatter:C,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),l(u,{inset:""},{default:v(()=>[l(i,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=a=>m.value=a),"label-width":"9em",label:t.$t("receivingAddress"),placeholder:t.$t("pleaseEnter"),"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),l(f,{type:"primary",round:"",block:"",class:"btn",onClick:S,loading:w.value,disabled:!p(_)},{default:v(()=>[H(N(t.$t("submitAdd")),1)]),_:1},8,["loading","disabled"])]),l($,{show:c.value,"onUpdate:show":e[3]||(e[3]=a=>c.value=a),title:t.$t("submitAddSuccessfully"),message:p(k),cancelButtonText:t.$t("thinkAgain"),confirmButtonText:t.$t("copyHash"),onOnConfirm:e[4]||(e[4]=a=>p(L)(g.value)),onOnCancel:e[5]||(e[5]=a=>c.value=!1)},null,8,["show","title","message","cancelButtonText","confirmButtonText"])],64)}}},Z=A(q,[["__scopeId","data-v-69e61b88"]]);export{Z as default};
