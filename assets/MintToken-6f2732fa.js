import{D as F}from"./Dialog-9cbf5b6a.js";import{_ as U,d as M,b as x,f as D,e as k,g as d,r as h,o as H,k as N,a as I,l as r,w as v,u as c,F as L,n as l,E as W,G,v as P,t as R}from"./index-9eae6901.js";import{u as j}from"./manage-d6c0ca92.js";import{f as b,c as q}from"./index-66b42143.js";import{p as z,f as J}from"./units-86d8ffcb.js";/* empty css                                                       */import"./bignumber-3e8dfdf6.js";const K={class:"mint-token"},Q={__name:"MintToken",setup(X){const{t:o}=M(),_=x(),C=D(),a=j(),S=k(()=>_.walletAddress.toLowerCase()===a.owner.toLowerCase()),g=d(""),s=d(_.walletAddress),u=d(""),A=k(()=>o("operationHash",{hash:b(g.value)})),w=d(!1),y=d(!1);function V(t){return t.replace("-","")}async function $(){if(!u.value){l(o("amountEmpty"));return}if(u.value.replace(".","").length>34){l(o("amountOver"));return}let t=u.value.split(".");if(t[1]&&t[1].length>a.decimals){l(o("amountOver"));return}if(!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(s.value)){l(o("addressWrong"));return}y.value=!0;try{const m=await new W(window.ethereum).getSigner(),i=new G(a.tokenAddress,a.abi,m);let f=await i.mint(s.value,z(u.value,a.decimals));g.value=f.hash,f.wait().then(async n=>{if(n.status===1){l({type:"success",message:o("upChainSuccessfully")});let E=await i.totalSupply();a.totalSupply=J(E.toString(),a.decimals),u.value=""}}),w.value=!0}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?l(o("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?l(o("userCancelOperate")):l(o("unkonwError"))}finally{y.value=!1}}async function B(){C.push("/manage/"+a.deployerId+"/"+a.tokenAddress)}const p=d(s.value?b(s.value):"");function T(){p.value=s.value}function O(){s.value=p.value,/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(s.value)?p.value=b(s.value):l(o("addressWrong"))}return(t,e)=>{const m=h("van-field"),i=h("van-cell-group"),f=h("van-button");return H(),N(L,null,[I("div",K,[r(i,{inset:""},{default:v(()=>[r(m,{modelValue:c(a).totalSupply,"onUpdate:modelValue":e[0]||(e[0]=n=>c(a).totalSupply=n),readonly:"",label:t.$t("currentTotal"),"input-align":"right"},null,8,["modelValue","label"])]),_:1}),r(i,{inset:""},{default:v(()=>[r(m,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),"label-width":"7em",type:"number",label:t.$t("mintTokenAmount"),placeholder:t.$t("pleaseEnter"),formatter:V,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(i,{inset:""},{default:v(()=>[r(m,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=n=>p.value=n),onFocus:T,onBlur:O,"label-width":"9em",label:t.$t("receivingAddress"),placeholder:t.$t("pleaseEnter"),"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(f,{type:"primary",round:"",block:"",class:"btn",onClick:$,loading:y.value,disabled:!c(S)},{default:v(()=>[P(R(t.$t("submitAdd")),1)]),_:1},8,["loading","disabled"])]),r(F,{show:w.value,"onUpdate:show":e[3]||(e[3]=n=>w.value=n),title:t.$t("submitAddSuccessfully"),message:c(A),showCancelButton:!1,confirmButtonText:t.$t("copyHash"),onOnConfirm:e[4]||(e[4]=n=>c(q)(g.value)),onOnCancel:B},null,8,["show","title","message","confirmButtonText"])],64)}}},le=U(Q,[["__scopeId","data-v-b25f097f"]]);export{le as default};
